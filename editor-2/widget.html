<var>matrix page editor</var> 
<script type="text/javascript">
//<![CDATA[
    jQuery.noConflict();  
(function($) {  
// Init 
$(document).ready(function() { 
    $('#cc-inner .j-hgrid').unwrap().wrap( "<div class='m-section' />" );  
    $(".cc-m-htmlcode").hover(
            function () {
                $("var,ins", this).show().css("display", "block");
            },
            function () {
                $("var,ins", this).hide();
            }
        );
    $('var').each(function () {
            $(this).closest('.m-section').removeClass().addClass($(this).text());
        });
// color setup
var $color1 = $(".color1");
var $color2 = $(".color2");
var $color3 = $(".color3");
var $color4 = $(".color4");
var $color5 = $(".color5");
var $color6 = $(".color6");
// main primary color
var color = $color1.css("background-color");
document.documentElement.style.setProperty('--bg-primary', color);

// primary light color
var color = $color2.css("background-color");
document.documentElement.style.setProperty('--bg-primary-light', color);

// primary dark color
var color = $color3.css("background-color");
document.documentElement.style.setProperty('--bg-primary-dark', color);

// secondary color
var color = $color4.css("background-color");
document.documentElement.style.setProperty('--bg-secondary', color);

// secondary dark color
var color = $color5.css("background-color");
document.documentElement.style.setProperty('--bg-secondary-dark', color);

// buttons
var color = $color6.css("background-color");
    document.documentElement.style.setProperty('--bg-btn-01', color);

    // body classes
    if( $('.is-boxed').length ){
     $('body').addClass('has-sidebar');
}
    // mobile switch
    $('.matrix-view').on('click', function(event){
      event.preventDefault();
$("#cms", window.parent.document).parent().parent().parent().toggleClass("j-prev-phone-portrait");          
 });  
    $('.cc-m-all-opened .is-fluid').removeAttr('data-mce-style');
    $('.j-module:has(.matrix-save)').closest('.j-hgrid').insertAfter($(".content-switcher"));
    

// draggable options
$(".matrix .is-fluid").draggable({
    containment: "parent",
    stop: function () {
        var l = ( 100 * parseFloat($(this).position().left / parseFloat($(this).parent().width())) ) + "%" ;
        var t = ( 100 * parseFloat($(this).position().top / parseFloat($(this).parent().height())) ) + "%" ;
        $(this).css("left", l);
        $(this).css("top", t);
                   
    }
});
$(".matrix .is-fluid-area .is-fluid").resizable({
    containment: "parent",        
    autoHide: true,
    stop: function(e, ui) {
        var parent = ui.element.parent();
        ui.element.css({
            width: ui.element.width()/parent.width()*100+"%",
            height: ui.element.height()/parent.height()*100+"%"
        });
    }
});
   
    $(".reset-btn").click(function () {  
// Reset position
        // $('.cc-m-all-opened .is-fluid').removeAttr('style');
// Destroy original draggable and create new one
          $(".matrix .is-fluid").draggable("destroy"); 
    $(".matrix .is-fluid").draggable();
        // $('.ui-resizable-handle').remove();
});  
    $(".edit-btn").click(function () {
    $(".matrix .is-fluid").draggable("destroy"); 
 }); 
// delete-btn
    $(".btn-delete").click(function(){
    $(this).parent().remove();          
 });
// copy-btn   
    $('.btn-add').click(function () {
    $(this).parent('.is-fluid').clone().insertAfter($(this).parent());   
 });
    
// edit options
$(".matrix .is-fluid").draggable()
  .click(function() {
    $(this).draggable( {disabled: false});
}).dblclick(function() {
    $(this).draggable({ disabled: true });
});
   // remove data-mce
$('.is-fluid').removeAttr('data-mce-style');   
  // custom bg color 
     $('.bg-custom-color').each(function(){
    var bgColor = $(this).find('span').css('color');
       $(this).parent().attr('style', 'background-color: '+ bgColor +'!important');
});
    
});
})(jQuery); 
//]]>
</script>
<button class="btn btn-sm cc-m-save btn-save btn-float-left matrix-msg matrix-save invisible" data-action="save" style=
"width: 32px;height: 32px;position:fixed;text-align: center;top:1px;left:35px;z-index:999999;border:1px solid transparent;padding:5px;font-size:30px;background: #1ba9e1;color: #fff;-webkit-border-radius: 2px;border-radius:4px;">
&#160;</button><button class="btn btn-sm btn-float-left matrix-msg invisible matrix-view" style=
"width: 32px;height: 32px;position:fixed;text-align: center;top:1px;left:69px;z-index:999999;border:1px solid transparent;padding:5px;font-size:30px;background: #1ba9e1;color: #fff;-webkit-border-radius: 2px;border-radius:4px;"
data-action="save">&#160;</button>
